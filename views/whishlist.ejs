<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Lora:wght@400;500;600;700&family=Poppins:wght@300;400;500;600&family=Rubik:wght@300;400&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/whishlist.css" />

    <title>Whistlist</title>
  </head>
  <body>
    <div class="container nav-container">
      <div class="nav-main">
        <h2 class="navmain-heading">VRNA</h2>
        <h5>SHOP</h5>
        <h5>CONTACT</h5>
        <h5>ABOUT</h5>
      </div>
      <div class="nav-sec">
        <h4></h4>
          <a class="icons" href="/user/Whishlist"
            ><ion-icon name="heart-outline"></ion-icon
          ></a>
        </h4>
        <!-- <h4><ion-icon name="search-outline"></ion-icon> </h4> -->
        <h4>
          <a class="icons" href="/user/userprofile"
            ><ion-icon name="person-outline"></ion-icon
          ></a>
        </h4>
        <h4>
          <div class="cart-icon-container">
            <a class="icons" href="/user/usercart">
              <ion-icon name="cart-outline"></ion-icon>
            </a>
          </div>
        </h4>

        <h5>
          <form action="/user/logout?_method=DELETE" method="post">
            <button class="logout-btn" type="submit">Log Out</button>
          </form>
        </h5>
      </div>
      <!-- Collapsible button for icons on screens smaller than 600px -->
      <div class="nav-collapsible-btn">
        <button id="collapsibleBtn" class="icons-collapsible-btn">
          <ion-icon name="menu-outline"></ion-icon>
        </button>

        <!-- Collapsible icons -->
        <div class="icons-collapsible">
          <a class="icons" href="/user/Whishlist"
            ><ion-icon name="heart-outline"></ion-icon
          ></a>
          <a class="icons" href="/user/userprofile"
            ><ion-icon name="person-outline"></ion-icon
          ></a>
          <div class="cart-icon-container">
            <a class="icons" href="/user/usercart">
              <ion-icon name="cart-outline"></ion-icon>
            </a>
          </div>
          <form action="/user/logout?_method=DELETE" method="post">
            <button class="logout-btn" type="submit">Log Out</button>
          </form>
        </div>
      </div>
    </div>
    <h2 class="primary-heading">Whistlist</h2>
    <div class="container outerContainer">
      <div class="container text-center cardContainer">
        <div class="addcontainer">
          <div class="searchbox">
            <form id="searchForm" method="GET" class="d-flex" role="search">
              <input
                id="searchInput"
                name="query"
                class="form-control me-2"
                type="search"
                placeholder="Search"
                aria-label="Search"
              />
              <button class="btn btn-outline-success" type="submit">
                Search
              </button>
            </form>
          </div>
        </div>

        <div class="container text-center cardContainer">
          <div class="row">
            <% for (let i = 0; i < products.length; i++) { %> <% if (i % 4 ===
            0) { %>
          </div>
          <div class="row row-container">
            <% } %>
            <div class="col" id="card<%=products[i]._id%>">
              <div class="card" style="width: 18rem">
                <img
                  src="<%= products[i].productImages[0] %>"
                  class="card-img-top"
                  alt="<%= products[i].productName %>"
                />
                <div class="card-body">
                  <h5 class="card-title"><%= products[i].productName %></h5>
                  <p class="card-text">discription</p>
                  <p class="card-text">$<%= products[i].productPrice %></p>
                  <div class="link-container">
                    <a
                      href="/admin/product/<%=products[i]._id%>"
                      class="btn btn-Buynow"
                      >Buy Now</a
                    >
                    <a
                      class="card-icon heart-icon"
                      href="#"
                      data-list-id="<%=products[i]._id%>"
                      ><ion-icon
                        name="heart-outline"
                        class="heart"
                        id="heart<%=products[i]._id%>"
                      ></ion-icon
                    ></a>
                    <a
                      class="card-icon"
                      href="/user/addToCartBtn/<%=products[i]._id%>"
                      ><ion-icon
                        class="cart-icon"
                        name="cart-outline"
                      ></ion-icon
                    ></a>
                  </div>
                </div>
              </div>
            </div>
            <% } %>
          </div>
        </div>
      </div>
    </div>

    <footer>
      <div class="text-center footer-container">
        <div class="container">
          <div class="container row">
            <div class="col">
              <ul class="footerul">
                <li><h1 class="heading-footer footer-link">VRNA</h1></li>
                <li class="footer-link">
                  <p>
                    Workout Clothes designed to help you become your personal
                    best. Because when it comes to performing at your max, there
                    should be no obstacles – least of all your workout clothes.
                  </p>
                </li>
              </ul>
            </div>
            <div class="col">
              <ul class="footerul">
                <li><a class="footer-link" href="#">SHOPPING</a></li>
                <li><a class="footer-link" href="#">SALES</a></li>
              </ul>
            </div>
            <div class="col">
              <ul class="footerul">
                <li><a class="footer-link" href="#">SHOPPING</a></li>
                <li><a class="footer-link" href="#">Contact Us</a></li>
                <li><a class="footer-link" href="#">Payment Method</a></li>
                <li><a class="footer-link" href="#">Delivery</a></li>
              </ul>
            </div>
            <div class="col">
              <ul class="footerul">
                <li><a class="footer-link" href="#">NEWSLETTER</a></li>
                <li class="footer-link">
                  <p>
                    Be the first to know about new arrivals, look books, sales &
                    promos
                  </p>
                </li>
              </ul>
            </div>
          </div>
        </div>
        <br />
        <p class="copyright">Copyright © 3333 All rights reserved | VRNA</p>
      </div>
    </footer>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
      const links = document.querySelectorAll(".heart-icon");
      links.forEach((link) => {
        link.addEventListener("click", function (e) {
          e.preventDefault();
          const productid = link.getAttribute("data-list-id");

          console.log(productid);
          const heartIcon = document.getElementById(`heart${productid}`);
          // const currentBackgroundColor = getComputedStyle(heartIcon).backgroundColor;

          // if (currentBackgroundColor === "rgb(255, 0, 0)") {

          fetch("/user/removeproduct-whistlist", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({ productid }),
          }).then((response) => {
            if (response.ok) {
              heartIcon.style.backgroundColor = "none";
              heartIcon.style.borderRadius = "initial";
              heartIcon.style.color = "black";

              response.json().then((data) => {
                console.log(data);
                document.getElementById(`card${data.productid}`).style.display =
                  "none";
              });
            } else {
              console.log("Error removing from the wishlist");
            }
          });
          // }
        });
      });
      
     document.addEventListener("DOMContentLoaded", function() {
      var collapsibleBtn = document.getElementById("collapsibleBtn");
      var iconsCollapsible = document.querySelector(".icons-collapsible");
  
      collapsibleBtn.addEventListener("click", function() {
        iconsCollapsible.classList.toggle("show-icons");
      });
    });
    </script>

    <script
      type="module"
      src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"
    ></script>
    <script
      nomodule
      src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
